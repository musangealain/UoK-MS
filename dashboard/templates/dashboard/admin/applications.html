{% extends "dashboard/admin/base.html" %}
{% block title %}Admin - Applications{% endblock %}
{% block main %}
        <section class="page-header">
          <div>
            <h1>Applications</h1>
            <p>Review new student applications and make decisions.</p>
          </div>
          <div class="quick-actions">
            <a class="primary-btn" href="#">Export List</a>
            <a class="ghost-btn" href="#">Filters</a>
          </div>
        </section>

        <section class="panel">
          <div class="panel-header">
            <h2>Pending Applications</h2>
          </div>
          <div class="table-wrap">
            <table class="dashboard-table">
              <thead>
                <tr>
                  <th>Reg No.</th>
                  <th>Student No.</th>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Program</th>
                  <th>Status</th>
                  <th>Submitted</th>
                  <th>Portal Access</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                {% for app in applications %}
                  <tr>
                    <td>{{ app.reg_number }}</td>
                    <td>{{ app.student_number|default:"-" }}</td>
                    <td>{{ app.full_name }}</td>
                    <td>{{ app.email }}</td>
                    <td>{{ app.program }}</td>
                    <td>
                      <span class="status-badge status-{{ app.status }}">{{ app.get_status_display }}</span>
                    </td>
                    <td>{{ app.submitted_at|date:"Y-m-d" }}</td>
                    <td>
                      {% if app.status == "approved" and app.student_number %}
                        <span class="status-badge status-approved">Provisioned</span>
                      {% else %}
                        <span class="status-badge status-pending">Pending</span>
                      {% endif %}
                    </td>
                    <td>
                      <form class="action-form" method="post" action="{% url 'application_decision' app.id %}">
                        {% csrf_token %}
                        <button class="action-btn action-approve" name="decision" value="approve">Accept</button>
                        <button class="action-btn action-deny" name="decision" value="reject">Deny</button>
                      </form>
                      <form class="delete-form" method="post" action="{% url 'application_delete' app.id %}">
                        {% csrf_token %}
                        <button class="icon-btn icon-danger" type="submit" title="Delete application" aria-label="Delete application">
                          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                            <path d="M9 3h6l1 2h4v2H4V5h4l1-2Zm1 6h2v9h-2V9Zm4 0h2v9h-2V9ZM6 9h2v9H6V9Z"></path>
                          </svg>
                        </button>
                      </form>
                    </td>
                  </tr>
                {% empty %}
                  <tr>
                    <td colspan="9">No applications found.</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </section>
{% endblock %}
